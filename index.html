<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Deep learning for music separation</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/lirmm.css">
 		<link href="fontawesome-free-5.3.1-web/css/all.css" rel="stylesheet">
		<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous"> -->

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/github.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

				<section id="cover" data-background="css/theme/img/background-red.jpg" data-background-repeat="no-repeat" data-background-size="cover" data-background-position="0 0" data-state="no-title-footer no-progressbar has-dark-background">
					<h2 id="covertitle">Deep learning for music separation</h2>
					<p id="coverauthors">
						Antoine Liutkus & Fabian-Robert Stöter<br/>
						Inria and LIRMM, Montpellier<br/>
						<p>
							antoine.liutkus@inria.fr<br />
						</p>
						<p>
							fabian-robert.stoter@inria.fr<br />
							<i class="fab fa-twitter"></i>faroit
						</p>

					</p>
					<p>
					September 2nd, 2019
					</p>
					<p>
					<img src="css/theme/img/inria-cover.svg" id="inria" class="logo" alt="">
				</section>


<!-- Introduction

In an introductory section, we will motivate the tutorial by explaining how music separation with DNN emerged with
data-driven methods coming from machine-learning or image processing communities. This comes with machine-learning
tricks to make methods work in practice. Meanwhile, many audio processing good practices are often forgotten or not
correctly applied, although they are mandatory for good performance.
• Timeline for DNN music separation
A brief history of the topic in the bigger picture: machine learning on the one hand, source separation on the other
hand.
• Outline
The baseline system: what is the state of the art? Quick literature review
How to implement and make it work? The distinction between training and testing.
An audio demo of the critical impact of engineering for the “same” system.

-->

<!-- INTRODUCTION -->
<section>
	<h1>Music Unmixing/Separation</h1>
	<img width="45%" style="float:left" src="assets/intro1.png" alt="">
	<img class="fragment" width="45%" src="assets/intro2.png" alt="">
</section>

<section>
	<h1>Applications</h1>
	<img width="60%" style="float:right" src="assets/karaoke.jpg" alt="">

	<ul>
		<li>Automatic Karaoke</li>
		<li>Creative Music Production</li>
		<li>Active listening</li>
		<li>Upmixing (stereo $\Rightarrow$ 5.1)</li>
		<li>Music Education</li>
		<li>Pre-processing for MIR</li>
	</ul>
</section>

<!-- <section>
	<iframe class="stretch" data-src="audio/player_x.html"></iframe>
</section> -->

<section>
	<h1>Unmatched state of the art</h1>
	<ul>
		<li>Very active research community and evaluations
		<ul>
			<li>International campaigns: MIREX, SiSEC</li>
			<li>Not-so-recent fact: <strong>separation with DNN works</strong></li>
		</ul>
		<p>
		<img width="30%" style="float:right; margin-top:2%;" src="assets/stefanyuki.svg" alt="">
		<li  style="margin-top:4%;">State of the art: SONY corporation systems
		<ul>
			<li style="color:gray">S. Uhlich et al. "Deep neural network based instrument extraction from music." ICASSP 2015.</li>
			$\Rightarrow$ Vocals SDR: 5dB (SiSEC 2016)
			<li style="color:gray">S. Uhlich, et al. "Improving music source separation based on deep neural networks through data augmentation and network blending." ICASSP 2017.</li>
			$\Rightarrow$ Vocals SDR: 5.9dB (SiSEC 2018)
		</li></ul>
		<p>

		<li style="margin-top:4%;">Open (and popular) implementations 2.5 dB behind state of the art!
		<ul>
			<li><a href=https://github.com/MTG/DeepConvSep><i class="fab fa-github"></i>/MTG/DeepConvSep</a> (349<i class="fa fa-star" aria-hidden="true"></i>) 2.5 dB vocals SDR (SiSEC'16)
			<div style="color:gray"><font size="4">P. Chandna et al. "Monoaural audio source separation using deep convolutional neural networks", LVA-ICA, 2017.</font></div>
			</li>
			<li><a href=https://github.com/f90/Wave-U-Net><i class="fab fa-github"></i>/f90/Wave-U-Net</a> (309<i class="fa fa-star" aria-hidden="true"></i>) 3.3 dB vocals SDR (SiSEC'18)
			<div style="color:gray"><font size="4">D. Stoller "Wave-u-net: A multi-scale neural network for end-to-end audio source separation." arXiv, 2018.</font></div>
			</li>
		</ul>
	</ul>
</section>

<section>
	<h1>Motivations of this tutorial</h1>
		<h2>Understand source separation</h2>
		<ul>
			<li>Signal processing aspects</li>
			<li>Quick overview of the topic</li>
			<li>Discriminative and generative methods</li>
		</ul>
		<p>
		<h2>Understand deep neural nets</h2>
		<ul>
			<li>Fundamental models for static/temporal data</li>
			<li>A starter on training</li>
			<li>Models for audio</li>
		</ul>
		<p>
		<h2>Python practice</h2>
		<ul>
			<li>How to implement and train deep nets with Pytorch</li>
			<li>Official release of <code>open-unmix</code> today!
				<a href=https://github.com/sigsep/open-unmix-pytorch><i class="fab fa-github"></i>/sigsep/open-unmix-pytorch</a>
			</li>
			<li>MIT-licensed state of the art performance</li>
		</ul></li>
	</ul>
	<div style="margin-top:8%; color:gray">
	All slides and material available at:
	<a href=https://github.com/sigsep><i class="fab fa-github"></i>/sigsep</a>
</div>
</section>

<section>
	<h1>What <code>open-unmix</code> can achieve</h1>
	<iframe src='http://umx-sisec18.s3-website.eu-west-3.amazonaws.com/' style='height:500px;width:100%'></iframe>
</section>

<section>
	<h1>Tutorial general outline</h1>
	<ul>
		<li>Signal processing basics</li>
		<li>Evaluating source separation</li>
		<li>Datasets</li>
		<li><font color="red">Hands on oracle separation</font></li>
		<p>
		<li>A brief history of music separation</li>
		<li>A starter on deep neural networks</li>
		<li>Discriminative and generative separation</li>
		<li><font color="red">Hands on using pre-trained <code>open-unmix</code></font></li>
		<p>
		<li>Training a DNN</li>
		<li>Audio datasets</li>
		<li><font color="red">Hands on training on pytorch</font></li>
		<p>
		<li>The <code>open-unmix</code> story</li>
		<li>Testing tricks</li>
		<li><font color="red">Hands on testing tricks with <code>open-unmix</code></font></li>
		<p>
		<li>Conclusion</li>
	</ul>
</section>

<section>
	<h1>Signal processing</h1>
	<h2>Time-frequency representations</h2>
</section>

<section data-background-transition="none" data-state="no-title-footer"  data-background-image="assets/demotrack/mix.jpg">
	<!-- <h1><button data-audio="assets/demotrack/mixture.m4a">▶</button></h1> -->
	<h1 style="margin-top:5%; color:white">Mixture spectrogram</h1>
</section>
<section data-background-transition="none">
	<section data-background-transition="none" data-state="no-title-footer"  data-background-image="assets/demotrack/vocals.jpg">
		<!-- <h1><button data-audio="assets/demotrack/vocals.m4a">▶</button></h1> -->
		<h1 style="margin-top:5%; color:white">Vocals spectrogram</h1>
	</section>
	<section data-background-transition="none" data-state="no-title-footer"  data-background-image="assets/demotrack/drums.jpg">
		<!-- <h1><button data-audio="assets/demotrack/drums.m4a">▶</button></h1> -->
		<h1 style="margin-top:5%; color:white">Drums spectrogram</h1>
	</section>
	<section data-background-transition="none" data-state="no-title-footer"  data-background-image="assets/demotrack/bass.jpg">
		<!-- <h1><button data-audio="assets/demotrack/bass.m4a">▶</button></h1> -->
		<h1 style="margin-top:5%; color:white">Bass spectrogram</h1>
	</section>
</section>

<section>
	<h2>Spectral analysis as pre-whitening</h2>
	<img style="float:right" width="50%" src="assets/fourier_whitening.svg" alt="">
	<ul>
		<li>Frames too short: not diagonalized</li>
		<li>Frames too long: not stationary</li>
	</ul>
</section>

<section>
	<!-- <h1>Time-frequency representations</h1> -->
	<h2>Spectral analysis as pre-whitening</h2>
	<img width="90%" src="assets/STFT.gif" alt="">
</section>

<section>
	<section>
		<h1>Filtering</h1>
		<img width="75%" src="assets/soft_masking_1.svg" alt="">
	</section>
	<section transition='none'>
		<h1>Filtering</h1>
		<img width="75%" src="assets/soft_masking_2.svg" alt="">
	</section>
	<section transition='none'>
		<h1>Filtering</h1>
		<img width="75%" src="assets/soft_masking_3.svg" alt="">
	</section>
	<section transition='none'>
		<h1>Filtering</h1>
		<img width="75%" src="assets/soft_masking_4.svg" alt="">
	</section>
	<section data-transition="none">
		<h1>Filtering</h1>
		<img width="75%" src="assets/soft_masking_5.svg" alt="">
		<img class="fragment" style="float:right" width="100%" src="assets/soft_masking_formula_potatoes.svg" alt="">
	</section>
	<section transition='none'>
		<h1>Filtering</h1>
		<img width="75%" src="assets/soft_masking_4.svg" alt="">
		<img style="float:right" width="100%" src="assets/soft_masking_formula.svg" alt="">
	</section>
</section>

<section>
	<h1>Evaluating quality</h1>
	<img style="float:right" width="100%" src="assets/evaluation_big_picture.svg" alt="">
</section>

<section>
	<h1>Perceptual evaluation: hot topics</h1>

	<ul>
		<li>Which questions to ask ?
			<p>
			<h6 style="margin-top:3%; color:gray">
			E. Cano et al. "The dimensions of perceptual quality of sound source separation." ICASSP, 2018.
			</h6>
		</li>
		<li>Referenceless evaluation
			<h6 style="margin-top:3%; color:gray">
			E. Grais et al. "Referenceless Performance Evaluation of Audio Source Separation using Deep Neural Networks." arXiv:1811.00454 (2018)</li>
			</h6>
		<li>Crowdsourced evaluations
			<h6 style="margin-top:3%; color:gray">
			M. Cartwright et al. "Crowdsourced Pairwise-Comparison for Source Separation Evaluation." ICASSP, 2018.</li>
			</h6>
</section>

<section>
	<h1>Objective evaluation</h1>
	<h2><img width="50px"src="assets/matlab.jpg" style="position:relative;left:0px; top:10px;" alt="">BSSeval v3</h2>
	All metrics in dB. The higher, the better:
	<ul>
		<li><strong>SDR</strong>: Source to distortion ratio. <em>Error in the estimate</em>.</li>
		<li><strong>SIR</strong>: Source to interference ratio. <em>Presence of other sources</em>.</li>
		<li><strong>SAR</strong>: Source to artifacts ratio. <em>Amount of artificial noise</em>.</li>
	</ul>
	<p>
	<h6 style="margin-top:2%; color:gray">
	E. Vincent et al. "Performance measurement in blind audio source separation."
	IEEE TASLP 14.4 (2006): 1462-1469.
	</h6>
	<h2><img width="50px"src="assets/python.jpg" style="position:relative;left:0px; top:25px;" alt="">museval (BSSeval v4)</h2>
	<ul>
		<li><strong>Better</strong> matching filters computed track-wise </li>
		<li><strong>Faster</strong> 10x</li>
		<li><code>pip install museval</code>, <a href=https://github.com/sigsep/sigsep-mus-eval><i class="fab fa-github"></i>/sigsep/sigsep-mus-eval</a></li>
	</ul>
	<h6 style="margin-top:2%; color:gray">
	F. Stöter et al. "The 2018 Signal Separation Evaluation Campaign."
	LVA/ICA 2018.
	</h6>
</section>

<section>
	<h1>Oracle evaluation</h1>
	<img style="float:right" width="100%" src="assets/oracle_evaluation.svg" alt="">
</section>


<section>
	<h1>Music separation datasets</h1>
	<table>
	   <thead>
	      <tr>
	         <th><strong>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></th>
	         <th><strong>Year</strong></th>
	         <th><strong>Reference&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></th>
	         <th><strong>#Tracks</strong></th>
	         <th><strong>Tracks&nbsp;dur&nbsp;(s)	</strong></th>
	         <th><strong>Full/stereo?</strong></th>
					 <th><strong>Total&nbsp;length</strong></th>
	      </tr>
	   </thead>
	   <tbody>
	      <tr>
	         <td>
	            <a href="http://www.mtg.upf.edu/download/datasets/mass" target="_blank" rel="noopener noreferrer">
	               MASS
	               <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound">
	                  <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path>
	                  <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon>
	               </svg>
	            </a>
	         </td>
	         <td>2008</td>
	         <td>(Vinyes)</td>
	         <td>9</td>
	         <td>
	            (16
	            <span class="katex">
	               <span class="katex-mathml">
	                  <math>
	                     <semantics>
	                        <mrow>
	                           <mo>±</mo>
	                        </mrow>
	                        <annotation encoding="application/x-tex">\pm</annotation>
	                     </semantics>
	                  </math>
	               </span>
	               <span aria-hidden="true" class="katex-html"><span class="strut" style="height: 0.58333em;"></span><span class="strut bottom" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="base"><span class="mord">±</span></span></span>
	            </span>
	            7)
	         </td>
	         <td>❌ / ✔️</td>
					 <td>2m24s</td>
	      </tr>
	      <tr>
	         <td>
	            <a href="https://sites.google.com/site/unvoicedsoundseparation/mir-1k" target="_blank" rel="noopener noreferrer">
	               MIR-1K
	               <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound">
	                  <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path>
	                  <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon>
	               </svg>
	            </a>
	         </td>
	         <td>2010</td>
	         <td>(Hsu and Jang)</td>
	         <td>1,000</td>
	         <td>8 <span class="katex"><span class="katex-mathml"></td>
	         <td>❌ / ❌</td>
					 <td>2h13m20s</td>
	      </tr>
	      <tr>
	         <td>
	            <a href="http://www.tsi.telecom-paristech.fr/aao/en/2012/03/12/quasi/" target="_blank" rel="noopener noreferrer">
	               QUASI
	               <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound">
	                  <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path>
	                  <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon>
	               </svg>
	            </a>
	         </td>
	         <td>2011</td>
	         <td>(Liutkus et al.)</td>
	         <td>5</td>
	         <td>
	            (206
	            <span class="katex">
	               <span class="katex-mathml">
	                  <math>
	                     <semantics>
	                        <mrow>
	                           <mo>±</mo>
	                        </mrow>
	                        <annotation encoding="application/x-tex">\pm</annotation>
	                     </semantics>
	                  </math>
	               </span>
	               <span aria-hidden="true" class="katex-html"><span class="strut" style="height: 0.58333em;"></span><span class="strut bottom" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="base"><span class="mord">±</span></span></span>
	            </span>
	            21)
	         </td>
	         <td>✔️ / ✔️</td>
					 <td>17m10s</td>
	      </tr>
	      <tr>
	         <td>
	            <a href="http://www.loria.fr/~aliutkus/kam/" target="_blank" rel="noopener noreferrer">
	               ccMixter
	               <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound">
	                  <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path>
	                  <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon>
	               </svg>
	            </a>
	         </td>
	         <td>2014</td>
	         <td>(Liutkus et al)</td>
	         <td>50</td>
	         <td>
	            (231
	            <span class="katex">
	               <span class="katex-mathml">
	                  <math>
	                     <semantics>
	                        <mrow>
	                           <mo>±</mo>
	                        </mrow>
	                        <annotation encoding="application/x-tex">\pm</annotation>
	                     </semantics>
	                  </math>
	               </span>
	               <span aria-hidden="true" class="katex-html"><span class="strut" style="height: 0.58333em;"></span><span class="strut bottom" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="base"><span class="mord">±</span></span></span>
	            </span>
	            77)
	         </td>
	         <td>✔️ / ✔️</td>
					 <td>3h12m30s</td>
	      </tr>
	      <tr>
	         <td>
	            <a href="http://medleydb.weebly.com/" target="_blank" rel="noopener noreferrer">
	               MedleyDB
	               <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound">
	                  <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path>
	                  <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon>
	               </svg>
	            </a>
	         </td>
	         <td>2014</td>
	         <td>(Bittner et al)</td>
	         <td>63</td>
	         <td>
	            (206
	            <span class="katex">
	               <span class="katex-mathml">
	                  <math>
	                     <semantics>
	                        <mrow>
	                           <mo>±</mo>
	                        </mrow>
	                        <annotation encoding="application/x-tex">\pm</annotation>
	                     </semantics>
	                  </math>
	               </span>
	               <span aria-hidden="true" class="katex-html"><span class="strut" style="height: 0.58333em;"></span><span class="strut bottom" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="base"><span class="mord">±</span></span></span>
	            </span>
	            121)
	         </td>
	         <td>✔️ / ✔️</td>
					 <td>3h36m18s</td>
	      </tr>
	      <tr>
	         <td>
	            <a href="http://mac.citi.sinica.edu.tw/ikala/" target="_blank" rel="noopener noreferrer">
	               iKala
	               <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound">
	                  <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path>
	                  <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon>
	               </svg>
	            </a>
	         </td>
	         <td>2015</td>
	         <td>(Chan et al)</td>
	         <td>206</td>
	         <td>30</td>
	         <td>❌ / ❌</td>
					 <td>1h43m</td>
	      </tr>
	      <tr>
	         <td><a href="/datasets/dsd100.html" class="">DSD100</a><span class="badge"></span></td>
	         <td>2015</td>
	         <td>(Ono et al)</td>
	         <td>100</td>
	         <td>
	            (251
	            <span class="katex">
	               <span class="katex-mathml">
	                  <math>
	                     <semantics>
	                        <mrow>
	                           <mo>±</mo>
	                        </mrow>
	                        <annotation encoding="application/x-tex">\pm</annotation>
	                     </semantics>
	                  </math>
	               </span>
	               <span aria-hidden="true" class="katex-html"><span class="strut" style="height: 0.58333em;"></span><span class="strut bottom" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="base"><span class="mord">±</span></span></span>
	            </span>
	            60)
	         </td>
	         <td>✔️ / ✔️</td>
					 <td>6h58m20s</td>
	      </tr>
	      <tr>
	         <td><a href="/datasets/musdb.html" class="">MUSDB18</a></td>
	         <td>2017</td>
	         <td>(Rafii et al)</td>
	         <td>150</td>
	         <td>
	            (236
	            <span class="katex">
	               <span class="katex-mathml">
	                  <math>
	                     <semantics>
	                        <mrow>
	                           <mo>±</mo>
	                        </mrow>
	                        <annotation encoding="application/x-tex">\pm</annotation>
	                     </semantics>
	                  </math>
	               </span>
	               <span aria-hidden="true" class="katex-html"><span class="strut" style="height: 0.58333em;"></span><span class="strut bottom" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="base"><span class="mord">±</span></span></span>
	            </span>
	            95)
	         </td>
	         <td>✔️ / ✔️</td>
					 <td>9h50m</td>
	      </tr>
	   </tbody>
	</table>
</section>

<section>
	<h1>The MUSDB18 dataset</h1>
	<ul>
		<li>100 train / 50 test full tracks</li>
		<li>Mastered with pro. digital audio workstations</li>
		<li>compressed STEMS (<code>MUSDB18</code>) and uncompressed WAV <code>MUSDB18-HQ</code>
		<li>Parser and Evaluation tools in <i class="fab fa-python"></i></li>
		<li><a ref=https://sigsep.github.io/datasets/musdb.html>https://sigsep.github.io/datasets/musdb.html</a></li>
	</ul>
	<img width="320px" style="float: right" src="assets/ni_logo.png" alt="">
	<img width="60%" src="assets/hero.svg" alt="">
</section>


<section>
	<h1>Hands on oracle separation</h1>
	<h2>Exploring MUSDB18</h2>
	<ul>
		<li>Start the notebook session</li>
		<li>For one track, display waveforms, play some audio</li>
		<li>Display spectrogram of mixture</li>
	</ul>
	<h2>Oracle separation</h2>
	<ul>
		<li>Get spectrograms of the sources</li>
		<li>Display the corresponding soft-mask for vocals</li>
		<li>Apply it on the mixture, reconstruct and listen to the result</li>
	</ul>
	<h2>Performance evaluation</h2>
	<ul>
		<li>Loop over some musdb tracks</li>
		<li>Evaluate oracle separation system on musdb</li>
		<li>Compare to state of the art (SiSEC18)</li>
	</ul>
</section>

<section>
	<h1>A brief history of separation</h1>
	<h2>The big picture</h2>
	<div class="centered">
		<img width="90%" class="stretch" src="assets/discriminative_big_picture.svg" alt="">
	</div>
	<h6 style="margin-top:3%; color:gray">
	Rafii, Zafar, et al. "An Overview of Lead and Accompaniment Separation in Music."
	IEEE/ACM TASLP 26.8 (2018): 1307-1335.
	</h6>
</section>

<section>
	<section>
		<h1>A brief history: model-driven methods</h1>
		<h2>Harmonicity for the lead</h2>
		<img style="float:right" width="70%" src="assets/model_based/ReviewPaper_ Figure2.svg" alt="">
		<ul>
			<li>Pitch detection</li>
			<li>Clean voices</li>
			<li>"Metallic" artifacts</li>
		</ul>
		<!-- an example -->
	</section>

	<section>
		<h1>A brief history: model-driven methods</h1>
		<h2>Redundancy for the accompaniment: NMF</h2>
		<img style="float:right" width="38%" src="assets/model_based/ReviewPaper_ Figure3.svg" alt="">
		<ul>
			<li>Spectral templates</li>
			<li>Low-rank assumptions</li>
			<li>Bad generalization</li>
		</ul>
		<!-- an example -->
	</section>

	<section>
		<h1>A brief history: model-driven methods</h1>
		<h2>Redundancy for the accompaniment: RPCA</h2>
		<p>
		<img style="margin-top:4%;" width="90%" src="assets/model_based/ReviewPaper_ Figure4.svg" alt=""><p>
		<ul>
			<li>Low-rank for music</li>
			<li>Vocals as unstructured</li>
			<li>Strong interferences in general</li>
		</ul>
		<!-- an example -->
	</section>

	<section>
		<h1>A brief history: model-driven methods</h1>
		<h2>Redundancy for the accompaniment: REPET</h2>
		<img style="float:right; margin-top:4%" width="65%" src="assets/model_based/ReviewPaper_ Figure5.svg" alt="">
		<ul>
			<li>Repetitive music</li>
			<li>Non-repetitive vocals</li>
			<li>Solos in vocals</li>
		</ul>
	</section>

	<section>
		<h1>A brief history: model-driven methods</h1>
		<h2> Modeling both lead and accompaniment: source filter</h2>
		<img style="float:right" width="70%" src="assets/model_based/ReviewPaper_ Figure7.svg" alt="">
		<ul>
			<li>Harmonic vocals</li>
			<li>Low-rank music</li>
			<li>Poor generalization</li>
		</ul>
	</section>

	<section>
		<h1>A brief history: model-driven methods</h1>
		<img style="float:right" width="43%" src="assets/model_based/ReviewPaper_ Figure8.svg" alt="">
		<h2>Cascaded methods</h2>
		<ul>
			<li>Combining methods</li>
			<li>Handcrafted systems</li>
			<li>Poor generalization</li>
		</ul>
	</section>

	<section>
		<h1>A brief history: model-driven methods</h1>
		<h2>Fusion of methods</h2>
		<img style="float:right" width="49%" src="assets/model_based/ReviewPaper_ Figure9.svg" alt="">
		<ul>
			<li>Combining in a data-driven way</li>
			<li>Doing best than all</li>
			<li>Computationally demanding</li>
		</ul>
	</section>
</section>


<!-- DEEP NEURAL NETWORKS -->
<section>
	<h1>A starter on deep neural networks</h1>
	<h6 style="margin-top:50%; color:gray">
	Y. LeCun, et al. "Deep learning". nature, 521(7553), 436 (2015).
</h6>
</section>

<section>
	<h1>Static data</h1>
	<h2>The basic fully connected layer</h2>
	<img width="80%" src="assets/one_layer.svg" alt="">
	<img class="fragment" style="float:right" width="60%" src="assets/non_linearities.svg" alt="">
</section>

<section>
	<h1>Static data</h1>
	<h2>Basic fully connected network</h2>
	<img  style="margin-top:5%" width="100%" src="assets/several_layers.svg" alt="">
</section>

<section>
	<h1>Static data</h1>
	<h2>A usual deep network</h2>
	<img  style="margin-top:5%" width="100%" src="assets/several_layers_general.svg" alt="">
	<ul class="fragment">
		<li>Cascading linear and non-linear operations augments expressive power</li>
		<li>7 millions parameters in our case</li>
	</ul>
</section>

<section>
	<h1>Temporal data</h1>
	<h6 style="margin-top:50%; color:gray">
		colah's blog, <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">Understanding LSTM Networks</a>, 2015.
	</h6>
</section>

<section>
	<section>
		<h1>Temporal data</h1>
		<h2>From fully connected to the simple recurrent net</h2>
		<img  style="float:center" width="90%" src="assets/recurrent_layer_1.svg" alt="">
	</section>
	<section>
		<h1>Temporal data</h1>
		<h2>From fully connected to the simple recurrent net</h2>
		<img  style="float:center" width="90%" src="assets/recurrent_layer_2.svg" alt="">
	</section>
	<section>
		<h1>Temporal data</h1>
		<h2>From fully connected to the simple recurrent net</h2>
		<img  style="float:center" width="90%" src="assets/time_distributed_dense.svg" alt="">
	</section>
	<section>
		<h1>Temporal data</h1>
		<h2>From fully connected to the simple recurrent net</h2>
		<img  style="float:center" width="90%" src="assets/recurrent_layer_3.svg" alt="">
	</section>

	<section>
		<h1>Temporal data</h1>
		<h2>The simple recurrent net</h2>
		<img  style="float:left" width="24%" src="assets/recurrent_layer_4.svg" alt="">
		<ul>
			<li>$y_{t}=f\left(linear\left\{ x_{t},y_{t-1}\right\} \right)$</li>
			<li>Similar to a Markov model
				<ul>
					<li>Exponential decay of information</li>
					<li>Vanishing or exploding gradient for training</li>
				</ul></li>
		</ul>
		<p>
		<ul>
			<li>Limited for long-term dependencies</li>
		</ul>
		<h6 style="margin-top:30%; color:gray">
			P. Huang, et al. "Deep learning for monaural speech separation". (2014) ICASSP.
		</h6>
	</section>
</section>

<section>
	<section>
		<h1>Temporal data</h1>
		<h2>The long short term memory (LSTM)</h2>
		<img  style="margin-top:2%; float:center" width="100%" src="assets/lstm_1.svg" alt="">
	</section>
	<section>
		<h1>Temporal data</h1>
		<h2>The long short term memory (LSTM)</h2>
		<img  style="margin-top:2%; float:center" width="100%" src="assets/lstm_2.svg" alt="">
	</section>
	<section>
		<h1>Temporal data</h1>
		<h2>The long short term memory (LSTM)</h2>
		<img  style="margin-top:2%; float:center" width="80%" src="assets/lstm_3.svg" alt="">
	</section>
</section>

<section>
	<section>
		<h1>Temporal data</h1>
		<h2>The bi-LSTM</h2>
		<img  style="margin-top:2%; float:left" width="50%" src="assets/blstm_1.svg" alt="">
		<ul>
			<li>LSTM are causal systems</li>
			<li>Predicts future from past</li>
		</ul>
	</section>
	<section>
		<h1>Temporal data</h1>
		<h2>The bi-LSTM</h2>
		<img  style="margin-top:2%; float:left" width="50%" src="assets/blstm_2.svg" alt="">
		<ul>
			<li>We can use anti-causal LSTM</li>
			<li>Different predictions!</li>
		</ul>
	</section>
	<section>
		<h1>Temporal data</h1>
		<h2>The bi-LSTM</h2>
		<img  style="margin-top:2%; float:left" width="50%" src="assets/blstm_3.svg" alt="">
		<ul>
			<li>Independent forward and backward</li>
			<li>Outputs can be concatenated</li>
			<li class="fragment">Outputs can be summed<p>
			<img  style="margin-top:2%; float:center" width="100%" src="assets/combine_blstm.svg" alt="">
		</li>
		</ul>
	</section>

</section>

<section>
	<h1>Discriminative source separation: one source</h1>
	<img width="48%" style="margin-top:5%; float:left" src="assets/discriminative_main_lines.svg" alt="">
	<img width="20%" style="margin-top:7%; float:left" src="assets/vanilla.svg" alt="">
	<ul style="margin-top:3%;">
		<li>Directly get source from mixture</li>
		<li>Straightforward inference</li>
		<li>Trained on paired mixtures/sources</li>
	</ul>
</section>

<section>
	<h1>Discriminative source separation: all sources</h1>
	<img width="100%" style="float:center" src="assets/vanilla_lstm_test.svg" alt="">
	<h6 style="margin-top:4%; color:gray">
		S. Uhlich, et al. "Improving music source separation based on deep neural networks through data augmentation and network blending." (2017) ICASSP.
	</h6>
</section>


<section>
	<h1>Generative source separation</h1>
	<img width="48%" style="margin-top:5%; float:left" src="assets/generative_model.svg" alt="">
	<ul style="margin-top:5%;">
		<li>The model can transform random noise to realistic spectrograms</li>
		<li>Training is done on sources only, without mixtures</li>
	</ul>
</section>

<section>
	<h1>Inference for generative separation</h1>
	<img width="100%" style="margin-top:1%; float:left" src="assets/generative_test.svg" alt="">
	<ul style="margin-top:5%;">
		<li>Testing requires inference of the latent variables ("noise")</li>
	</ul>
</section>

<section>
	<style>
		.container{display: flex;}
		.col1{flex: 3;}
		.col2{flex: 1;}
	</style>

	<h1>Inference for generative separation: recent pointers</h1>
	<div class="container">
		<div class="col1">
			<ul>Rejection sampling with Variational autoencoders
				<li style="color:gray">
						S. Leglaive et al. "A variance modeling framework based on variational autoencoders for speech enhancement" MLSP, 2018.
				</li>
				<li  style="color:gray">
						Y. Bando  et al. "Statistical speech enhancement based on probabilistic integration of variational autoencoder and non-negative matrix factorization", ICASSP 2018
				</li>
			</ul>
			<p>
			<ul>Rejection sampling with GANs
				<li style="color:gray">
						Y. Subakan et al. "Generative adversarial source separation", ICASSP 2018.
				</li>
			</ul>
		<p>
		<ul>Inference with encoder networks
			<li style="color:gray">
					M. Pariente et al. "A statistically principled and computationally efficient approach to speech enhancement using variational autoencoders" arXiv, 2019.
			</li>
		</ul>
		</div>
		<div class="col2">
			<img width="100%" style="margin-top:1%; float:right" src="assets/iterative_generative_test.svg" alt="">
		</div>
	</div>
</section>

<section>
	<h1>Hands on using pre-trained <code>open-unmix</code></h1>
	<ul style="margin-top:10%">
		<li>Load the pre-trained <code>open-unmix</code></li>
		<p>
		<li>Separate on MUSDB7 track</li>
		<p>
		<li>Compute scores and compare with oracle</li>
	</ul>
	<p>
</section>



<section>
	<h1>Training a DNN</h1>
	<ul>
		<li>Vocabulary</li>
		<li>Gradient descent</li>
		<li>Discriminative training</li>
		<li>Generative training</li>
	</ul>
</section>

<section>
	<h1>Vocabulary</h1>
	<img  style="margin-top:5%" width="100%" src="assets/training_dataset.svg" alt="">
</section>

<section>
	<h1>Vocabulary</h1>
	<img  style="margin-top:5%" width="100%" src="assets/training_dataset_batch.svg" alt="">
</section>

<section>
	<h1>Vocabulary</h1>
	<img  style="margin-top:5%" width="100%" src="assets/training_dataset_learning.svg" alt="">
</section>

<section>
	<h1>Vocabulary</h1>
	<img  style="margin-top:5%" width="100%" src="assets/one_epoch.gif" alt="">
</section>

<section>
	<h1>Gradient descent</h1>
	<img  style="margin-top:5%; float:right" width="43%" src="assets/gradient_descent.gif" alt="">
	<ul>
		<li>$loss\leftarrow \sum_{(x,y)\in batch}cost\left(y_\Theta\left(x\right), y\right)$</li>
		<li>Update $\Theta$ to reduce the loss!</li>
		<p>
		<li>We can compute $\frac{\partial loss}{\partial\Theta_{i}}$ for any parameter $\Theta_i$
			<ul>
				<li>"The influence of $\Theta_i$ on the error"</li>
				<li>It's the <strong>gradient</strong></li>
				<li>Computed through <strong>backpropagation</strong></li>
			</ul>
		</li><p>
		<li>A simple optimization: $\Theta_i\leftarrow \Theta_i - \lambda \frac{\partial loss}{\partial\Theta_{i}}$
			<ul>
				<li>It's the <strong>stochastic gradient descent</strong></li>
				<li>$\lambda$ is the <strong>learning rate</strong></li>
			</ul>
		</li>
		<li>Batching is important</li>
	</ul>
	<p>
	There are many other optimization algorithms...
	<!--
	<h6 style="color:gray">
		<ul>
			<li><strong>RMSprop</strong> T. Tieleman, et al. "Lecture 6.5-rmsprop: Divide the gradient by a running average of its recent magnitude." COURSERA: Neural networks for machine learning 4.2 (2012): 26-31.
			<li><strong>Adam</strong>	D. Kingma, et al. "Adam: A method for stochastic optimization." arXiv preprint (2014) arXiv:1412.6980.

		</ul>
	</h6> -->
</section>

<section>
	<h1>Gradient descent</h1>
	<h2>Learning rate wisdom</h2>
	<img  style="margin-top:5%; " width="45%" src="assets/gradient_descent_big.gif" alt="">
	<!-- <img  style="margin-top:5%; float:center" width="33%" src="assets/gradient_descent.gif" alt=""> -->
	<img  style="margin-top:5%; " width="40%" src="assets/learningrates.jpg" alt="">
	<h6 style="margin-top:10%; color:gray">
		Leonardo Araujo dos Santos, <a href="https://leonardoaraujosantos.gitbooks.io/artificial-inteligence/content/model_optimization.html">Artificial Intelligence</a>, 2017.
	</h6>
</section>


<section>
	<h1>Gradient descent</h1>
	<h2>Regularization with dropout</h2>
	<img  style="margin-top:5%; float:left" width="30%" src="assets/dropout.gif" alt="">
	<ul style="margin-top:5%;">
		<li>Parts of the net randomly set to 0</li>
		<li>No unit should be critical: <i>regularization</i></li>
		<li>Probabilistic interpretation</li>
	</ul>
	<h6 style="margin-top:28%; color:gray">
		N Srivastava, et al. "Dropout: a simple way to prevent neural networks from overfitting". JMLR. (2014) 15(1), 1929-1958.
	</h6>
</section>

<section>
	<h1>Gradient descent</h1>
	<h2>Data augmentation</h2>
	<ul>
		<li>Artificially increase the size of the dataset</li>
		<p>
		<li>An active research topic in audio
			<ul style="color:gray">
				<li>S. Uhlich, et al. "Improving music source separation based on deep neural networks through data augmentation and network blending." (2017) ICASSP</li>
				<li>A. Cohen-Hadria, et al. "Improving singing voice separation using Deep U-Net and Wave-U-Net with data augmentation."" arXiv 2019.
			</ul>
		</li>
		<p>
		<li>Some simple ideas: random excerpts, random sources gains</li>
		<p>
		<img width="45%" style="float:center; margin-top=4%" src="assets/random_excerpts.svg" alt="">
		<img width="50%" style="float:center; margin-top=4%" src="assets/sources_gain_augmentation.svg" alt="">
	</ul>
</section>
<!--
<section>
	<h1>Discriminative training</h1>
	<img  style="margin-top:5%; float:center" width="20%" src="assets/sample_supervised.svg" alt="">
</section> -->

<section>
	<h1>Discriminative training</h1>
	<img width="100%" style="float:center" src="assets/sample_supervised_temporal.svg" alt="">
</section>

<section>
	<h1>Discriminative training, computing the loss</h1>
	<img  style="margin-top:5%; float:center" width="100%" src="assets/training_networks_0.svg" alt="">
</section>

<section>
	<h1>Discriminative training, computing the loss</h1>
	<img  style="margin-top:5%; float:center" width="100%" src="assets/training_networks_1.svg" alt="">
</section>

<section>
	<h1>Discriminative training, computing the loss</h1>
	<img  style="margin-top:5%; float:center" width="100%" src="assets/training_networks_2.svg" alt="">
</section>

	<section>
		<h1>Discriminative training: the audio data-fit loss jungle</h1>
			<img width="20%" style="float:left" src="assets/cost_function.svg" alt="">
$loss=\sum_{b\in batch, f,t} d\left(Y_b\left(f,t\right),\hat{Y}_b\left(f,t\right)\right)$<p>
	<img width="30%" style="float:right" src="assets/costfunction_jungle.gif" alt="">
			<ul>
			<li>Wide variety of loss functions $d\left(a,b\right)$
				<ul>
					<li>squared loss $\left|a-b\right|^2$</li>
					<li>absolute loss $\left|a-b\right|$</li>
					<li>Kullback Leibler loss $a\log\frac{a}{b}-a+b$</li>
					<li>Itakura Saito loss $\frac{a}{b}-\log\frac{a}{b}-1$</li>
					<li>Cauchy, alpha divergence, ...<p></li>
				</ul>
			</li>
			<li>Applied on $Y$, $Y^2$, any $Y^\alpha$, $\log Y$, ...</li>
			<li>Theoretical groundings for all</li>
		</ul>
		<h6 style="margin-top:5%; color:gray">
			C. Févotte, et al. "Algorithms for nonnegative matrix factorization with the β-divergence." Neural computation 23.9 (2011): 2421-2456.
		</h6>
		<h6 style="margin-top:1%; color:gray">
			A. Liutkus, et al. "Generalized Wiener filtering with fractional power spectrograms." (2015) ICASSP.
		</h6>
		<!-- SOME HANDS ON IN THE PRACTICE SESSION ? -->
	</section>

	<section>
		<h1>Discriminative training: the audio data-fit loss jungle</h1>
		<img width="30%" style="float:center" src="assets/costfunctions_SDR.png" alt="">
		<img width="30%" style="float:center" src="assets/costfunctions_SIR.png" alt="">
		<img width="30%" style="float:center" src="assets/costfunctions_SAR.png" alt="">
		<h6 style="margin-top:2%; color:gray">
			A. Nugraha, et al. "Multichannel Audio Source Separation With Deep Neural Networks." TASLP 24.9 (2016): 1652-1664.
		</h6>
	</section>

<section>
	<h1>Generative training: Generative Adversarial Networks</h1>
	<h6 style="margin-top:2%; color:gray">
		Y. Subakan et al. "Generative adversarial source separation", ICASSP 2018.
	</h6>
	<img width="75%" style="margin-top:1%; float:left" src="assets/GAN_training.svg" alt="">

</section>
<section>
	<h1>Generative training: Variational Auto-Encoders</h1>
	<h6 style="margin-top:2%; color:gray">
		S. Leglaive et al. "A variance modeling framework based on variational autoencoders for speech enhancement" MLSP, 2018.
	</h6>
	<img width="90%" style="margin-top:1%; float:left" src="assets/VAE_training.svg" alt="">
</section>

<section>
	<h1>Audio datasets in <code>open-unmix</code></h1>
	<h2>Paired sampling: AlignedDataset</h2>
	<img width="100%" style="float:left" src="assets/AlignedDataset.svg" alt="">
</section>

<section>
	<h1>Audio datasets in <code>open-unmix</code></h1>
	<h2>Unpaired sampling: SourceFolderDataset</h2>
	<img width="100%" style="float:left" src="assets/SourceFolderDataset.svg" alt="">
</section>

<section>
	<h1>Audio datasets in <code>open-unmix</code></h1>
	<h2>Paired/Unpaired sampling: FixedSourcesTrackFolderDataset</h2>
	<img width="100%" style="float:left" src="assets/FixedSourcesTrackFolderDataset.svg" alt="">
</section>

<section>
	<h1>Audio datasets in <code>open-unmix</code></h1>
	<h2>Paired sampling: VariableSourcesTrackFolderDataset</h2>
	<img width="100%" style="float:left" src="assets/VariableSourcesTrackFolderDataset.svg" alt="">
</section>

<!-- <section>
	<h1>Audio datasets</h1>
	<h2>Hierarchical sampling</h2>
	<img width="40%" style="margin-top:8%; float:left" src="assets/audio_dataset.svg" alt="">
	<div style="margin-top:2%">
		<ul>
			<li>Audio datasets are made of tracks</li>
			<li>Samples are short excerpts</li>
		</ul>
	<p>
	$\Rightarrow$ How to organize sampling?
	</div>
</section>

<section>
	<h1>Audio datasets</h1>
	<h2>Hierarchical sampling</h2>
	<img width="62%" style="float:left" src="assets/twsw.gif" alt="">
	<ul>
		<li>Non unique tracks in batch</li>
		<li>Not all samples per epoch</li>
	</ul>
</section>

<section>
	<h1>Audio datasets</h1>
	<h2>Hierarchical sampling</h2>
	<img width="62%" style="float:left" src="assets/twosw.gif" alt="">
	<ul>
		<li>Unique tracks in batch</li>
		<li>Not all samples per epoch</li>
	</ul>
</section>

<section>
	<h1>Audio datasets</h1>
	<h2>Hierarchical sampling</h2>
	<img width="62%" style="float:left" src="assets/twswo.gif" alt="">
	<ul>
		<li>Non unique tracks in batch</li>
		<li>All samples per epoch</li>
	</ul>
</section>

<section>
	<h1>Audio datasets</h1>
	<h2>Hierarchical sampling</h2>
	<img width="62%" style="float:left" src="assets/twoswo.gif" alt="">
	<ul>
		<li>Unique tracks in batch</li>
		<li>All samples per epoch</li>
	</ul>
</section> -->

<section>
	<h1>Hands-on training a discriminative model using pytorch</h1>
		<h2>Data</h2>
			<ul>
				<li>Create a simple MUSDB18 dataset, examples of samples</li>
				<li>Compute statistics for scaler</li>
				<li>Create the sampler</li>
			</ul>
		<h2>Model</h2>
			<ul>
				<li>Create a model, an optimizer</li>
			</ul>
		<h2>Training loop</h2>
			<ul>
				<li>Compute loss</li>
				<li>Back-propagation + gradient descent</li>
			</ul>
		<h2>UMX training tricks <a href=https://github.com/sigsep/open-unmix-pytorch/blob/master/train.py><i class="fab fa-github"></i>/sigsep/open-unmix-pytorch/train.py</a> </h2>
			<ul>
				<li>Learning-rate schedulers</li>
				<li>Early stopping</li>
			</ul>
		<h2>Adapt to a SourceFolderDataset</h2>
	</ul>
</section>

<section>
	<section>
		<h1>The <code>open-unmix</code> (UMX) story</h1>
		<img  style="margin-top:5%; float:left" width="100%" src="assets/UMX1.svg" alt="">
	</section>
	<section>
		<h1>The <code>open-unmix</code> (UMX) story</h1>
		<img  style="margin-top:5%; float:left" width="160%" src="assets/UMX2.svg" alt="">
	</section>
	<section>
		<h1>The <code>open-unmix</code> (UMX) story</h1>
		<img  style="margin-top:5%; float:left" width="160%" src="assets/UMX3.svg" alt="">
		<ul style="margin-top:5%;">
			<li>Input and output scaling are good for training
			<div><font color=gray>S. Uhlich et al. "Deep neural network based instrument extraction from music." ICASSP 2015.</font></div></li>
		</ul>
	</section>
	<section>
		<h1>The <code>open-unmix</code> (UMX) story</h1>
		<img  style="margin-top:5%; float:left" width="160%" src="assets/UMX4.svg" alt="">
		<ul style="margin-top:5%;">
			<li>Skip-connections <font color=red>do not</font> increase expressive power, but good impact on training
			<div><font color=gray>R. Gribonval et al. "Approximation spaces of deep neural networks." arXiv 2019.</font></div></li>
		</ul>

	</section>
	<section>
		<h1>The <code>open-unmix</code> (UMX) story</h1>
		<img  style="margin-top:5%; float:left" width="160%" src="assets/UMX5.svg" alt="">
		<ul style="margin-top:5%">
			<li>Instance normalization removes dependency on mixture scale
			<div><font color="green">$\Rightarrow$ It makes the model insensitive to mixture scale</font></div></li>
			<li>This is our ISMIR'18 version</li>
		</ul>
	</section>

	<section>
		<style>
			.container{display: flex;}
			.col_in_l{flex: 1;}
			.col_in_r{flex: 3;}
		</style>
		<h1>Training the ISMIR'18 version</h1>
		<div class="container">
			<div class="col_in_l">
				<img  width="70%" src="assets/UMX5_vert.svg" alt="">
			</div>
			<div class="col_in_r">
				<img width="100%" style="margin-top:0%" src="assets/loss_instance_norm.png" alt="">
				<ul>
					<li>Training goes well, no overfit</li>
					<li>Good performance: 5.8 dB vocals SDR on MUSDB18</li>
					<p>
					<li class="fragment" style="color:red">But scale of source is wrong!
					<div>$\Rightarrow$ Problematic for spectral subtraction, direct synthesis...</div></li>
				</ul>
			</div>
		</div>
	</section>
	<section>
		<h1>The <code>open-unmix</code> (UMX) story</h1>
		<img  style="margin-top:5%; float:left" width="160%" src="assets/UMX5.svg" alt="">
		<ul style="margin-top:5%">
			<li>Let's replace instance normalization by a classical batch normalization</li>
		</ul>
	</section>
	<section>
		<h1>The <code>open-unmix</code> (UMX) story</h1>
		<img  style="margin-top:5%; float:left" width="160%" src="assets/UMX6.svg" alt="">
		<div class="fragment" style="position:absolute; margin-bottom:-10%;bottom:0; left:0;"><i class="far fa-lightbulb"></i> Use the model to predict a filter on the mixture!</div>
	</section>
	<section>
		<h1>The <code>open-unmix</code> (UMX) story</h1>
		<img  style="margin-top:2%; float:left" width="160%" src="assets/UMX.svg" alt="">
		<ul style="margin-top:1%;">
			<li>The model now learns how to mask the mixture
			<div class="fragment"><font color="green">$\Rightarrow$ Sources scales should be good</font></div>
			<div class="fragment"><font color="green">$\Rightarrow$ Loss computed on spectrograms, not masks</font></div></li>
			</li>
		</ul>
	</section>
</section>

<section>
	<section>
		<style>
			.container{display: flex;}
			.col_umx_l{flex: 1.5;}
			.col_umx_r{flex: 3;}
		</style>
		<h1>Training the final version</h1>
		<div class="container">
			<div class="col_umx_l">
				<img  width="80%" src="assets/UMX_vert.svg" alt="">
			</div>
			<div class="col_umx_r">
				<img width="100%" src="assets/loss_realmagnitude.png" alt="">
				<ul>
					<li>Training goes <font color="red">wrong</font>, strong overfit</li>
					<li class="fragment">Performance drop of ~2 dB !!</li>
				</ul>
			</div>
		</div>
	</section>

	<section>
		<style>
			.container{display: flex;}
			.col_interp_l{flex: 2;}
			.col_inter_r{flex: 1;}
		</style>
		<h1>What happened?!</h1>
		<div class="container">
			<div class="col_interp_l">
				<img  style="margin-top:5%; float:left" width="90%" src="assets/panic.svg" alt="">
			</div>
			<div class="col_interp_r">
				<ul style="margin-top:5%">
					<li class="fragment" data-fragment-index="1">Masking version:</li>
					<div class="fragment" data-fragment-index="1"><i class="fas fa-exclamation-triangle"></i> Training set too easy to remember?</div>
					<p>
					<li class="fragment">But <code>instancenorm</code> was working!</li>
					<div class="fragment"><i class="far fa-lightbulb"></i> It was making the true source unreachable!</div>
					<div class="fragment" style="color:green">$\Rightarrow$ Preventing overfitting</div>
				</ul>
			</div>
		</div>
		<img  class="fragment" style="margin-top:1%; float:right" width="60%" src="assets/fight.svg" alt="">
	</section>

	<section>
		<h1>Fighting overfitting</h1>
		<div class="container">
			<div class="col_umx_l">
				<img  width="80%" src="assets/UMX_vert.svg" alt="">
			</div>
			<div class="col_umx_r">
				Before:
				<img width="100%" src="assets/loss_realmagnitude.png" alt="">
			</div>
		</div>
	</section>

	<section>
		<h1>Fighting overfitting</h1>
		<div class="container">
			<div class="col_umx_l">
				<img  width="80%" src="assets/UMX_vert.svg" alt="">
			</div>
			<div class="col_umx_r">
				After:
				<img width="100%" src="assets/loss_regularized.png" alt="">
				<ul>
					<li>Random excerpts, higher patience</li>
					<li>Fixed learning rate decay (120 epochs)</li>
					<p>
					$\Rightarrow$ <font color="green">Back to 5.6 dB </font></li>
				</ul>
			</div>
		</div>
	</section>

	<section>
		<h1>Final tuning</h1>
		<div class="container">
			<div class="col_umx_l">
				<img  width="80%" src="assets/UMX_vert.svg" alt="">
			</div>
			<div class="col_umx_r">
				<img width="100%" src="assets/loss_umxselection.png" alt="">
				<ul>
					<li>Random sources gains, random stereo swapping</li>
					<li>Take sources from random tracks</li>
					<li>Add weight decay</li>
					<li>Increase dropout rate</li>
					<li>Learning rate decay on plateau ($\times 0.1$)</li>
					<li>Select the best of several seeds</li>
				</ul>
			</div>
		</div>
	</section>
	<section>
		<h1><code>open-unmix</code>: final model (<code>UMX</code>)</h1>
		<div class="container">
			<div class="col_umx_l">
				<img  width="80%" src="assets/UMX_vert.svg" alt="">
			</div>
			<div class="col_umx_r">
				<img width="100%" src="assets/loss_umx.png" alt="">
				<p>
				$\Rightarrow$ <font color="green">Reach 6.3 dB vocals SDR on MUSDB18</font>
			</div>
		</div>
	</section>
	<section>
		<h1>Spoiler: final model with <font color="black">much</font> more data (<code>UMXpro</code>)</h1>
		<div class="container">
			<div class="col_umx_l">
				<img  width="80%" src="assets/UMX_vert.svg" alt="">
			</div>
			<div class="col_umx_r">
				<img width="100%" src="assets/loss_umxpro.png" alt="">
				<p>
				$\Rightarrow$ <font color="green">Reach 7.5 dB vocals SDR on MUSDB18</font>
			</div>
		</div>
	</section>
</section>

<!-- TESTING -->
<section>
	<h1>Outline</h1>
	<h2>Testing</h2>
	<ul>
		<li>Representation</li>
		<li>Mono filter tricks</li>
		<li>Multichannel Gaussian model</li>
		<li>The multichannel Wiener filter</li>
	</ul>
</section>

<section>
	<h1>Testing: representations</h1>
	<img src="assets/clickiness.png" alt="">
	<ul>
		<li>The first source of poor results: inverse STFT!</li>
		<li>Verify perfect reconstruction</li><p>
		<li>Better: use established libraries, like <code>librosa</code>, <code>scipy</code>...</li>
	</ul>
</section>

<section>
	<h1>Testing: mono filter tricks</h1>
	<h2>Logit filters</h2>
	<img  style="margin-top:0%; float:left" width="50%" src="assets/logit_trick.svg" alt="">
	<ul>
		<li>If the mask is 0.8... just put 1</li>
		<li>If the mask is 0.2... just put 0</li>
		<li>Cheap interference reduction</li>
	</ul>
	<p>
	<i style="position:absolute; right:2%; bottom:2%" class="fa fa-headphones"></i>
</section>

<section>
	<section>
		<h1>Multichannel Gaussian model</h1>
		<img  style="margin-top:0%; float:left" width="100%" src="assets/stereo_explanation_1.svg" alt="">
	</section>
	<section>
		<h1>Multichannel Gaussian model</h1>
		<img  style="margin-top:0%; float:left" width="100%" src="assets/stereo_explanation_2.svg" alt="">
	</section>
	<section>
		<h1>Multichannel Gaussian model</h1>
		<img  style="margin-top:0%; float:left" width="100%" src="assets/stereo_explanation_3.svg" alt="">
	</section>
	<section>
		<h1>Multichannel Gaussian model</h1>
		<img  style="margin-top:0%; float:left" width="100%" src="assets/stereo_explanation_4.svg" alt="">
	</section>
	<section>
		<h1>Multichannel Gaussian model</h1>
		<img  style="margin-top:0%; float:left" width="100%" src="assets/stereo_explanation_5.svg" alt="">
	</section>
	<section>
		<h1>Multichannel Gaussian model</h1>
		<img  style="margin-top:0%; float:left" width="100%" src="assets/stereo_explanation_6.svg" alt="">
	</section>
	<section>
		<h1>Multichannel Gaussian model</h1>
		<img  style="margin-top:0%; float:left" width="100%" src="assets/stereo_explanation_7.svg" alt="">
	</section>
	<section>
		<h1>Multichannel Gaussian model</h1>
		<img  style="margin-top:0%; float:left" width="100%" src="assets/stereo_explanation_8.svg" alt="">
	</section>
	<section>
		<h1>Multichannel Gaussian model</h1>
		<img  style="margin-top:0%; float:left" width="100%" src="assets/stereo_explanation_9.svg" alt="">
	</section>
	<section>
		<h1>Multichannel Gaussian model</h1>
		<img  style="margin-top:0%; float:left" width="100%" src="assets/stereo_explanation_10.svg" alt="">
	</section>
	<section>
		<h1>Multichannel Gaussian model</h1>
		<img  style="margin-top:0%; float:left" width="100%" src="assets/stereo_explanation_11.svg" alt="">
	</section>
</section>
<section>
	<section>
		<h1>Testing: the multichannel Wiener filter</h1>
		<img  style="margin-top:3%; float:center" width="70%" src="assets/joint_distribution_source_mix.svg" alt="">
		<ul style="margin-top:3%">
			<li>Sources and mixtures are jointly Gaussian</li>
			<li>We observe the mix, what can we say about the sources?</li>
		</ul>
	</section>
	<section>
		<h1>Testing: the multichannel Wiener filter</h1>
		<img  style="margin-top:5%; float:left" width="100%" src="assets/joint_gaussian_1.svg" alt="">
	</section>
	<section>
		<h1>Testing: the multichannel Wiener filter</h1>
		<img  style="margin-top:5%; float:left" width="100%" src="assets/joint_gaussian_2.svg" alt="">
	</section>
	<section>
		<h1>Testing: the multichannel Wiener filter</h1>
		<img  style="margin-top:5%; float:left" width="100%" src="assets/joint_gaussian_3.svg" alt="">
	</section>
	<section>
		<h1>Testing: the multichannel Wiener filter</h1>
		<img  style="margin-top:5%; float:left" width="100%" src="assets/joint_gaussian_4.svg" alt="">
	</section>
	<section>
		<h1>Testing: the multichannel Wiener filter</h1>
		<img  style="margin-top:5%; float:left" width="100%" src="assets/joint_gaussian_6.svg" alt="">
	</section>
	<section>
		<h1>Testing: the multichannel Wiener filter</h1>
		<img  style="margin-top:5%; float:left" width="100%" src="assets/joint_gaussian_7.svg" alt="">
	</section>

	<section>
		<h1>Testing: the Expectation-Maximization algorithm</h1>
		<img  style="margin-top:5%; float:left" width="100%" src="assets/expectation_maximization_big_picture.svg" alt="">
	</section>
</section>

<section>
	<h1>The norbert package</h1>
	<img  style="margin-top:2%; float:right" width="15%" src="assets/norbert.svg" alt="">
	<h2>Installation</h2>
	<ul>
		<li><a href=https://github.com/sigsep/norbert><i class="fab fa-github"></i>/sigsep/norbert</a></li>
		<li><code>pip install norbert</code></li>
	</ul>
	<h2>Usage</h2>
	<ul>
		<li>Easy computation of soft masks</li>
		<li>Easy computation of optimal (stereo) Wiener filters</li>
		<li>Expectation-maximization algorithm</li>
		<li>Spectral subtraction</li>
	</ul>

	<pre class="python">
		norbert.softmask(v, x, logit=None, eps=None)
		norbert.wiener(v, x, iterations=1, use_softmask=True, eps=None)
		norbert.expectation_maximization(y, x, iterations=2, verbose=0, eps=None)
		norbert.contrib.residual_model(v, x, alpha=1)
	</pre>
</section>

<section>
	<h1>Hands on: inference with <code>open-unmix</code></h1>
	<i class="fas fa-link"></i><a href=https://open.unmix.app>open.unmix.app</a>
	<p>
	<ul>
		<li>Running MUSDB18 separation</li>
		<li>Tuning test-time parameters</li>
	</ul>

	boxplots if available<p>
</section>

<section>
	<h1>Conclusion</h1>
</section>


<section>
	<section>
		<h1>Conclusion: the open source unmix</h1>
		<h6 style="margin-top:0%;color:gray">
			F. Stöter et al, "Open-Unmix - A reference implementation for audio source separation", JOSS 2019.
		</h6>

		<img  style="margin-top:0%; float:left" width="100%" src="assets/boxplot_full.svg" alt="">
	</section>

	<section>
		<h1>Conclusion: the open source unmix</h1>
		<h6 style="margin-top:0%;color:gray">
			F. Stöter et al, "Open-Unmix - A reference implementation for audio source separation", JOSS 2019.
		</h6>
		<img style="margin-top:0%; float:left" width="54%" src="assets/pairwise_new.svg" alt="">
		<ul>
			<li>State of the art performance</li>
				<div>$\Rightarrow$ 6.3 dB vocals SDR</div>
			<p>
			<li>Close to binary oracles!</li>
			<p>
			<li><a href=https://github.com/sigsep/open-unmix-pytorch><i class="fab fa-github"></i>/sigsep/open-unmix-pytorch</a></li>
		</ul>
		<img width="22%" style="margin-top:10%; float:right" src="assets/mission_accomplished.svg" alt="">
	</section>
</section>

<section>
	<h1>Conclusion: what was kept out</h1>
	<h2>Exotic representations</h2>
		<ul>
			<li>Scattering transforms, wavelets, etc.</li>
			<li>End-to-end separation: wavenet, etc.
				<div style="color:red"><i class="fas fa-exclamation-triangle"></i> wave-U-net:  3.3 dB vocals SDR</div>
			</li>
		</ul>
	<h2>Alternative structures</h2>
		<ul>
			<li>The convolutional neural network (CNN)</li>
			<li>The U-NET</li>
			<li>The MM-densenet</li>
		</ul>
	<h2>Deep clustering strategy</h2>
	<div>$\Rightarrow$ Useful for separating sources of same type (e.g. voice & voice)</div>
	<div>$\Rightarrow$ Not so common in music</div>

	<h2>Advanced data augmentation</h2>
</section>

<section>
	<h1>Conclusion: what is promising</h1>
	<h2>Scale</h2>
	<ul>
		<li>More data helps immensely</li>
		<li>Evaluate scalability of an idea / a model</li>
	</ul>
	<p>
	<h2>Hot topics</h2>
	<ul>
		<li>Structures with more parameters work better...</li>
		<li>Better signal processing helps</li>
		<li>Generative ideas, even if lagging behind in performance</li>
	</ul>
	<h2>Engineering</h2>
	<ul>
		<li>We got 3dB SDR improvement with no publishable contribution</li>
		<div>$\Rightarrow$ evaluating the real impact of a contribution is difficult</div>
		<li>Real-time / frontend separation</li>
	</ul>
</section>

<section>
	<h1>Conclusion: advertising <code>UMX-Pro</code></h1>
</section>
<section>
	<h1>Conclusion: ending remarks</h1>
	<ul>
		<li>Convergence of signal processing, probability theory and DL</li>
		<li>Learning with limited amount of data</li>
		<li>Model long term dependency</li>
		<li>Representation learning for sound and music</li>
		<li>Exploiting knowledge domain, user interaction</li>
		<li>Unsupervised learning ?</li>
	</ul>
	<p>
	<h1>Resources</h1>
	<ul>
		<li>References and Software tools: <a href="https://sigsep.github.io">sigsep.github.io</a></li>
		<li>Open-unmix website: <a href="https://open.unmix.app">open.unmix.app</a></li>
	</ul>
	<p>
	<h1>Reference</h1>
	<h6 style="margin-top:0%;color:gray">
		F. Stöter et al, "Open-Unmix - A reference implementation for audio source separation", JOSS 2019.
	</h6>

</section>

			</div>
			<div class='footer'>
				<img src="css/theme/img/inria-bottom.svg" alt="Logo" />
				<div id="middlebox">Deep Learning for Music Unmixing</div>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				controls: true,
				progress: false,
				history: true,
				center: false,
				slideNumber: true,
				minScale: 1,
				maxScale: 5,
				viewDistance: 30,
				transition: 'none', //

				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'node_modules/reveald3/reveald3.js' },
					{ src: 'plugin/math-katex/math-katex.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
